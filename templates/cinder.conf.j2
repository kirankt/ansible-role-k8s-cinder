[DEFAULT]
glance_api_servers={{result.conf_dict['DEFAULT']['glance_api_servers']}}
glance_api_version={{result.conf_dict['DEFAULT']['glance_api_version']}}
enable_v3_api=True
storage_availability_zone=nova
default_availability_zone=nova
auth_strategy={{result.conf_dict['DEFAULT']['auth_strategy']}}
enabled_backends={{ enabled_backends | join(",") }}
nova_catalog_info=compute:nova:internalURL
nova_catalog_admin_info=compute:nova:adminURL
scheduler_driver=cinder.scheduler.filter_scheduler.FilterScheduler
osapi_volume_listen=0.0.0.0
osapi_volume_workers=2
log_dir=/var/log/cinder
transport_url=rabbit://{{result.conf_dict['oslo_messaging_rabbit']['rabbit_userid']}}:{{result.conf_dict['oslo_messaging_rabbit']['rabbit_password']}}@rabbitmq:{{result.conf_dict['oslo_messaging_rabbit']['rabbit_port']}}/?ssl=0
rpc_backend=rabbit
control_exchange=openstack
api_paste_config=/etc/cinder/api-paste.ini

[database]
connection=mysql+pymysql://{{result.conf_dict['database']['user']}}:{{result.conf_dict['database']['password']}}@{{result.conf_dict['database']['host']}}:3306/{{result.conf_dict['database']['dbname']}}
max_retries=-1
db_max_retries=-1

[oslo_concurrency]
lock_path=/var/lib/cinder/tmp

[oslo_messaging_notifications]
driver=messagingv2
transport_url=rabbit://{{result.conf_dict['oslo_messaging_rabbit']['rabbit_userid']}}:{{result.conf_dict['oslo_messaging_rabbit']['rabbit_password']}}@rabbitmq:{{result.conf_dict['oslo_messaging_rabbit']['rabbit_port']}}/?ssl=0

[oslo_messaging_rabbit]
ssl={{result.conf_dict['oslo_messaging_rabbit']['rabbit_use_ssl']}}
rabbit_port={{result.conf_dict['oslo_messaging_rabbit']['rabbit_port']}}
rabbit_userid={{result.conf_dict['oslo_messaging_rabbit']['rabbit_userid']}}
rabbit_password={{result.conf_dict['oslo_messaging_rabbit']['rabbit_password']}}
heartbeat_timeout_threshold={{result.conf_dict['oslo_messaging_rabbit']['rabbit_heartbeat_timeout_threshold']}}

[oslo_middleware]
enable_proxy_headers_parsing=True

[oslo_policy]
policy_file=/etc/cinder/policy.json

{% if result.conf_dict['cinder_enable_iscsi_backend'] %}
[tripleo_iscsi]
volume_backend_name=tripleo_iscsi
volume_driver=cinder.volume.drivers.lvm.LVMVolumeDriver
iscsi_ip_address=iscsid
iscsi_helper=lioadm
volumes_dir=/var/lib/cinder/cinder-volumes
iscsi_protocol=iscsi
{% endif %}

{% if result.conf_dict['dellemc_xtremio_iscsi_backend'] %}
[xtremio]
max_over_subscription_ratio = {{result.conf_dict['xtremio']['max_over_subscription_ratio']}}
use_multipath_for_image_xfer= {{result.conf_dict['xtremio']['use_multipath_for_image_xfer']}}
volume_backend_name=xtremio
volume_driver=cinder.volume.drivers.emc.xtremio.XtremIOISCSIDriver
san_ip={{result.conf_dict['xtremio']['san_ip']}}
xtremio_cluster_name={{result.conf_dict['xtremio']['xtremio_cluster_name']}}
san_login={{result.conf_dict['xtremio']['san_login']}}
san_password={{result.conf_dict['xtremio']['san_password']}}
image_volume_cache_enabled={{result.conf_dict['xtremio']['image_volume_cache_enabled']}}
{% endif %}

{% if result.conf_dict['cinder_enable_rbd_backend'] %}
[tripleo_ceph]
volume_backend_name=tripleo_ceph
volume_driver=cinder.volume.drivers.rbd.RBDDriver
rbd_ceph_conf=/etc/ceph/ceph.conf
rbd_user={{ result.conf_dict['cinder_rbd_user_name'] }}
rbd_pool={{ result.conf_dict['cinder_rbd_pool_name'] }}
rbd_secret_uuid={{ result.conf_dict['ceph_cluster_fsid'] }}
backend_host=hostgroup
{% endif %}

{% if result.conf_dict['cinder_enable_netapp_backend'] %}
[tripleo_netapp]
title = tripleo_netapp
netapp_login = {{result.conf_dict['tripleo_netapp']['netapp_login']}}
netapp_password = {{result.conf_dict['tripleo_netapp']['netapp_password']}}
netapp_server_hostname = {{result.conf_dict['tripleo_netapp']['netapp_server_hostname']}}
netapp_server_port = {% if {{result.conf_dict['tripleo_netapp']['netapp_server_port']}} %} {{result.conf_dict['tripleo_netapp']['netapp_server_port']}} {% else %} 80 {% endif %}
netapp_size_multiplier = {% if {{result.conf_dict['tripleo_netapp']['netapp_size_multiplier']}} %} {{result.conf_dict['tripleo_netapp']['netapp_size_multiplier']}} {% else %} 1.2 {% endif %}
netapp_storage_family = {% if {{result.conf_dict['tripleo_netapp']['netapp_storage_family']}} %} {{result.conf_dict['tripleo_netapp']['netapp_storage_family']}} {% else %} ontap_cluster {% endif %}
netapp_storage_protocol =  {% if {{result.conf_dict['tripleo_netapp']['netapp_storage_protocol']}} %} {{result.conf_dict['tripleo_netapp']['netapp_storage_protocol']}} {% else %} nfs {% endif %}
netapp_transport_type = {% if {{result.conf_dict['tripleo_netapp']['netapp_transport_type']}} %} {{result.conf_dict['tripleo_netapp']['netapp_transport_type']}} {% else %} nfs {% endif %}
netapp_vfiler = {% if {{result.conf_dict['tripleo_netapp']['netapp_vfiler']}} %} {{result.conf_dict['tripleo_netapp']['netapp_vfiler']}} {% else %} {% endif %}
netapp_volume_list = {% if {{result.conf_dict['tripleo_netapp']['netapp_volume_list']}} %} {{result.conf_dict['tripleo_netapp']['netapp_volume_list']}} {% else %} {% endif %}
netapp_vserver = {% if {{result.conf_dict['tripleo_netapp']['netapp_vserver']}} %} {{result.conf_dict['tripleo_netapp']['netapp_vserver']}} {% else %} {% endif %}
netapp_partner_backend_name = {% if {{result.conf_dict['tripleo_netapp']['netapp_partner_backend_name']}} %} {{result.conf_dict['tripleo_netapp']['netapp_partner_backend_name']}} {% else %} {% endif %}
nfs_shares = {% if {{result.conf_dict['tripleo_netapp']['nfs_shares']}} %} {{result.conf_dict['tripleo_netapp']['nfs_shares']}} {% else %} {% endif %}
nfs_shares_config = {% if {{result.conf_dict['tripleo_netapp']['nfs_shares_config']}} %} {{result.conf_dict['tripleo_netapp']['nfs_shares_config']}} {% else %} /etc/cinder/shares.conf {% endif %}
nfs_mount_options = {% if {{result.conf_dict['tripleo_netapp']['nfs_mount_options']}} %} {{result.conf_dict['tripleo_netapp']['nfs_mount_options']}} {% else %} {% endif %}
netapp_copyoffload_tool_path = if {{result.conf_dict['tripleo_netapp']['netapp_copyoffload_tool_path']}} %} {{result.conf_dict['tripleo_netapp']['netapp_copyoffload_tool_path']}} {% else %} {% endif %}
netapp_controller_ips = if {{result.conf_dict['tripleo_netapp']['netapp_controller_ips']}} %} {{result.conf_dict['tripleo_netapp']['netapp_controller_ips']}} {% else %} {% endif %}
netapp_sa_password = if {{result.conf_dict['tripleo_netapp']['netapp_sa_password']}} %} {{result.conf_dict['tripleo_netapp']['netapp_sa_password']}} {% else %} {% endif %}
netapp_storage_pools = if {{result.conf_dict['tripleo_netapp']['netapp_storage_pools']}} %} {{result.conf_dict['tripleo_netapp']['netapp_storage_pools']}} {% else %} {% endif %}
netapp_host_type =if {{result.conf_dict['tripleo_netapp']['netapp_host_type']}} %} {{result.conf_dict['tripleo_netapp']['netapp_host_type']}} {% else %} {% endif %}
netapp_webservice_path = if {{result.conf_dict['tripleo_netapp']['netapp_webservice_path']}} %} {{result.conf_dict['tripleo_netapp']['netapp_webservice_path']}} {% else %} /devmgr/v2 {% endif %}
nas_secure_file_operations = if {{result.conf_dict['tripleo_netapp']['nas_secure_file_operations']}} %} {{result.conf_dict['tripleo_netapp']['nas_secure_file_operations']}} {% else %} false {% endif %}
nas_secure_file_permissions = if {{result.conf_dict['tripleo_netapp']['nas_secure_file_permissions']}} %} {{result.conf_dict['tripleo_netapp']['nas_secure_file_permissions']}} {% else %} false {% endif %}
{% endif %}

